{"remainingRequest":"C:\\Users\\Awa\\SocialNetwork\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Awa\\SocialNetwork\\frontend\\src\\components\\Posts.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Awa\\SocialNetwork\\frontend\\src\\components\\Posts.vue","mtime":1620383265888},{"path":"C:\\Users\\Awa\\SocialNetwork\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Awa\\SocialNetwork\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Awa\\SocialNetwork\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Awa\\SocialNetwork\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgUG9zdFNlcnZpY2UgZnJvbSAiLi4vc2VydmljZXMvUG9zdFNlcnZpY2UiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiUG9zdHMiLA0KICBwcm9wczogew0KICAgIHBvc3Q6IHsNCiAgICAgIHR5cGU6IE9iamVjdCwNCiAgICB9LA0KICB9LA0KICBkYXRhOiBmdW5jdGlvbigpIHsNCiAgICByZXR1cm4gew0KICAgICAgc2hvdzogZmFsc2UsDQogICAgICB3aWR0aDogNTAwLA0KICAgICAgY29tbWVudEZvcm06IGZhbHNlLA0KICAgICAgdXNlcjogZmFsc2UsDQogICAgICBzaG93RmVlZDogdHJ1ZSwNCiAgICAgIHVwZGF0ZTogZmFsc2UsDQogICAgICBpc1ZhbGlkOiB0cnVlLA0KICAgICAgcnVsZXM6IHsNCiAgICAgICAgcmVxdWlyZWQ6ICh2YWx1ZSkgPT4gISF2YWx1ZSB8fCAiUmVxdWlyZWQuIiwNCiAgICAgIH0sDQogICAgICBtZXNzYWdlUmV0b3VyOiBudWxsLA0KICAgICAgZXJyb3JNZXNzYWdlOiBudWxsLA0KICAgICAgZGF0YTogew0KICAgICAgICBjb21tZW50TWVzc2FnZTogIiIsDQogICAgICAgIGNvbW1lbnRQc2V1ZG86IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIucHNldWRvLA0KICAgICAgfSwNCiAgICB9Ow0KICB9LA0KICBjb21wdXRlZDogew0KICAgIGlzTGlrZWQoKSB7DQogICAgICBjb25zdCB1c2VySWQgPSB0aGlzLiRzdG9yZS5zdGF0ZS51c2VyLmlkOw0KICAgICAgbGV0IHVzZXJMaWtlID0gdGhpcy5wb3N0Lkxpa2VzLm1hcCgoYSkgPT4gYS5Vc2VySWQpOw0KICAgICAgaWYgKHVzZXJMaWtlLmluY2x1ZGVzKHVzZXJJZCkpIHsNCiAgICAgICAgcmV0dXJuICJwaW5rIjsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiAiIjsNCiAgICAgIH0NCiAgICB9LA0KICB9LA0KICBtZXRob2RzOiB7DQogICAgYXN5bmMgcmVsb2FkRmVlZCgpIHsNCiAgICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgUG9zdFNlcnZpY2UuZ2V0UG9zdHMoKTsNCiAgICAgICAgdGhpcy5wb3N0cyA9IHJlc3BvbnNlLmRhdGE7DQogICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IGVycm9yLnJlc3BvbnNlLmRhdGEuZXJyb3I7DQogICAgICB9DQogICAgfSwNCiAgICBnZXRQcm9maWxlKGlkKSB7DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaChgL2FjY291bnQvJHtpZH1gKTsNCiAgICB9LA0KICAgIGRlbGV0ZVBvc3QoKSB7DQogICAgICB0aGlzLiRlbWl0KCJkZWxldGVQb3N0IiwgdGhpcy5wb3N0LmlkKTsNCiAgICB9LA0KICAgIGxpa2VQb3N0KCkgew0KICAgICAgdGhpcy4kZW1pdCgibGlrZVBvc3QiLCB0aGlzLnBvc3QuaWQpOw0KICAgIH0sDQogICAgZ2V0T25lUG9zdChpZCkgew0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goYHBvc3RzLyR7aWR9YCk7DQogICAgfSwNCiAgICBvblN1Ym1pdENvbW1lbnQoaWQpIHsNCiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJnZXRQb3N0cyIpOw0KICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImNvbW1lbnRQb3N0Iiwgew0KICAgICAgICBpZDogaWQsDQogICAgICAgIGRhdGE6IHRoaXMuZGF0YSwNCiAgICAgIH0pOw0KICAgICAgdGhpcy5kYXRhLmNvbW1lbnRNZXNzYWdlID0gIiI7DQogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiZ2V0UG9zdHMiKTsNCiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJnZXRQb3N0QnlJZCIsIHRoaXMucG9zdC5pZCk7DQogICAgfSwNCiAgICBkZWxldGVDb21tZW50KGlkKSB7DQogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgiZGVsZXRlQ29tbWVudCIsIGlkKSwgdGhpcy5yZWxvYWRGZWVkKCk7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["Posts.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Posts.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <v-card class=\"posts-card mx-auto mt-4 mb-4 pb-5\" round elevation=\"2\">\r\n      <div>\r\n        <div class=\"d-flex justify-space-between pr-2 \">\r\n          <v-card-title class=\"post-title\">\r\n            <v-avatar class=\"profil-post\" size=\"52px\">\r\n              <img\r\n                v-if=\"post.User.photo\"\r\n                :src=\"post.User.photo\"\r\n                alt=\"Photo de profil\"\r\n              />\r\n              <v-icon\r\n                role=\"avatar personnalisé\"\r\n                v-else-if=\"\r\n                  post.User.photo === null &&\r\n                    post.User.id === $store.state.user.id\r\n                \"\r\n                color=\"pink\"\r\n                size=\"52px\"\r\n                >$vuetify.icons.account</v-icon\r\n              >\r\n              <v-icon role=\"avatar\" size=\"52px\" v-else\r\n                >$vuetify.icons.account</v-icon\r\n              >\r\n            </v-avatar>\r\n            <div class=\"nom-date mt-3\">\r\n              <span class=\"pseudo text-left ml-5\">{{ post.User.pseudo }}</span>\r\n              <span class=\"date ml-5 text-left\">{{\r\n                post.createdAt | moment(\"calendar\")\r\n              }}</span>\r\n            </div>\r\n          </v-card-title>\r\n          <div class=\"post-options\">\r\n            <v-tooltip v-if=\"$store.state.user.id == post.User.id\" bottom>\r\n              <template v-slot:activator=\"{ on, attrs }\">\r\n                <v-btn\r\n                  class=\"mx-2\"\r\n                  fab\r\n                  primary\r\n                  x-small\r\n                  v-bind=\"attrs\"\r\n                  v-on=\"on\"\r\n                  aria-label=\"modifier le post\"\r\n                  @click=\"getOnePost(post.id)\"\r\n                >\r\n                  <v-icon class=\" rounded-circle\">$vuetify.icons.update</v-icon>\r\n                </v-btn>\r\n              </template>\r\n              <span>Modifier</span>\r\n            </v-tooltip>\r\n            <v-tooltip\r\n              v-if=\"\r\n                $store.state.user.id === post.User.id ||\r\n                  $store.state.user.admin === true\r\n              \"\r\n              bottom\r\n            >\r\n              <template v-slot:activator=\"{ on, attrs }\">\r\n                <v-btn\r\n                  class=\"mx-2\"\r\n                  fab\r\n                  primary\r\n                  x-small\r\n                  v-bind=\"attrs\"\r\n                  v-on=\"on\"\r\n                  aria-label=\"supprimer le post\"\r\n                  @click=\"deletePost(post.id)\"\r\n                >\r\n                  <v-icon small class=\" rounded-circle\">\r\n                    $vuetify.icons.delete\r\n                  </v-icon>\r\n                </v-btn>\r\n              </template>\r\n              <span>Supprimer</span>\r\n            </v-tooltip>\r\n          </div>\r\n        </div>\r\n        <div class=\"pl-3 pr-2-3\">\r\n          <v-card-text class=\"text-left\">\r\n            <p class=\"body-1\">\r\n              {{ post.message }}\r\n            </p>\r\n          </v-card-text>\r\n        </div>\r\n        <div class=\"pb-5\">\r\n          <v-img\r\n            v-if=\"post.link\"\r\n            :src=\"post.link\"\r\n            alt=\"lien posté par l'utilisateur\"\r\n            :max-height=\"300\"\r\n            :max-width=\"400\"\r\n            class=\"mx-auto pb-5\"\r\n          >\r\n          </v-img>\r\n          <v-img\r\n            v-if=\"post.imageUrl\"\r\n            :src=\"post.imageUrl\"\r\n            alt=\"image postée par l'utilisateur\"\r\n            :max-height=\"600\"\r\n            :max-width=\"400\"\r\n            class=\"mx-auto pb-5\"\r\n          >\r\n          </v-img>\r\n        </div>\r\n        <v-divider></v-divider>\r\n        <div class=\"d-flex flex-column align-end pr-3\">\r\n          <div>{{ post.Comments.length }} comments</div>\r\n          <div>{{ post.Likes.length }} j'aime</div>\r\n        </div>\r\n        <v-divider></v-divider>\r\n        <v-card-actions class=\"pt-5  pr-4 d-flex justify-space-between\">\r\n          <div class=\" d-flex justify-md-space-between\">\r\n            <v-btn @click=\"show = !show\" text aria-label=\"accès commentaires\">\r\n              Commentaires\r\n            </v-btn>\r\n            <v-btn icon @click=\"show = !show\" aria-label=\"accès commentaires\">\r\n              <v-icon>{{\r\n                show ? \"mdi-chevron-up\" : \"mdi-chevron-down\"\r\n              }}</v-icon>\r\n            </v-btn>\r\n          </div>\r\n          <div class=\"d-flex  align-end pr-3\">\r\n            <v-btn\r\n              @click=\"likePost(post.id)\"\r\n              x-small\r\n              aria-label=\"liker\"\r\n              class=\"like-btn\"\r\n            >\r\n              <v-icon :color=\"isLiked\">\r\n                $vuetify.icons.like\r\n              </v-icon>\r\n            </v-btn>\r\n          </div>\r\n        </v-card-actions>\r\n        <v-expand-transition>\r\n          <div v-show=\"show\">\r\n            <v-divider></v-divider>\r\n            <div class=\"comments-box d-flex flex-column justify-center\">\r\n              <v-card-text class=\"comment-input\">\r\n                <v-form\r\n                  v-model=\"isValid\"\r\n                  @submit.prevent=\"onSubmitComment(post.id)\"\r\n                  enctype=\"multipart/form-data\"\r\n                  class=\"validate comment-form\"\r\n                >\r\n                  <v-text-field\r\n                    name=\"input-1-3\"\r\n                    label=\"ton commentaire\"\r\n                    v-model=\"data.commentMessage\"\r\n                    auto-grow\r\n                    class=\"comment-form__message input-group--focused\"\r\n                  >\r\n                  </v-text-field>\r\n                  <v-btn\r\n                    @click=\"onSubmitComment(post.id)\"\r\n                    :disabled=\"!isValid\"\r\n                    class=\"comment-form__btn\"\r\n                    aria-label=\"publier commentaire\"\r\n                    >Poster</v-btn\r\n                  >\r\n                </v-form>\r\n                <div>\r\n                  <div class=\"danger-alert\" v-html=\"errorMessage\" />\r\n                  <div class=\"danger-alert\" v-html=\"messageRetour\" />\r\n                </div>\r\n              </v-card-text>\r\n              <v-list\r\n                v-for=\"comment in post.Comments\"\r\n                :key=\"comment.id\"\r\n                :comment=\"comment\"\r\n              >\r\n                <v-list-item class=\"comment\">\r\n                  <v-list-item-avatar class=\"comment_photo\">\r\n                    <img\r\n                      v-if=\"comment.User.photo !== null\"\r\n                      :src=\"comment.User.photo\"\r\n                      alt=\"Photo de profil\"\r\n                    />\r\n                    <v-icon\r\n                      v-else-if=\"\r\n                        comment.User.photo === null &&\r\n                          comment.UserId === $store.state.user.id\r\n                      \"\r\n                      color=\"pink\"\r\n                      size=\"32px\"\r\n                      role=\"avatar\"\r\n                      >$vuetify.icons.account</v-icon\r\n                    >\r\n                    <v-icon v-else size=\"32px\" role=\"avatar\"\r\n                      >$vuetify.icons.account</v-icon\r\n                    >\r\n                  </v-list-item-avatar>\r\n\r\n                  <v-list-item-content class=\"comment_body d-flex \">\r\n                    <strong\r\n                      v-html=\"comment.User.pseudo\"\r\n                      class=\"pr-5 text-left  pseudo comment__pseudo\"\r\n                    ></strong>\r\n                    <span\r\n                      v-html=\"comment.message\"\r\n                      class=\" text-left comment__message\"\r\n                    ></span>\r\n                  </v-list-item-content>\r\n\r\n                  <v-tooltip bottom>\r\n                    <template\r\n                      v-if=\"\r\n                        $store.state.user.id === comment.UserId ||\r\n                          $store.state.user.admin === true\r\n                      \"\r\n                      v-slot:activator=\"{ on, attrs }\"\r\n                    >\r\n                      <v-btn fab primary x-small v-bind=\"attrs\" v-on=\"on\">\r\n                        <v-icon\r\n                          @click=\"deleteComment(comment.id)\"\r\n                          class=\" rounded-circle \"\r\n                          aria-label=\"supprimer commentaire\"\r\n                          >$vuetify.icons.delete\r\n                        </v-icon>\r\n                      </v-btn>\r\n                    </template>\r\n                    <span>Supprimer</span>\r\n                  </v-tooltip>\r\n                </v-list-item>\r\n                <v-divider></v-divider>\r\n              </v-list>\r\n            </div>\r\n          </div>\r\n        </v-expand-transition>\r\n      </div>\r\n    </v-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport PostService from \"../services/PostService\";\r\nexport default {\r\n  name: \"Posts\",\r\n  props: {\r\n    post: {\r\n      type: Object,\r\n    },\r\n  },\r\n  data: function() {\r\n    return {\r\n      show: false,\r\n      width: 500,\r\n      commentForm: false,\r\n      user: false,\r\n      showFeed: true,\r\n      update: false,\r\n      isValid: true,\r\n      rules: {\r\n        required: (value) => !!value || \"Required.\",\r\n      },\r\n      messageRetour: null,\r\n      errorMessage: null,\r\n      data: {\r\n        commentMessage: \"\",\r\n        commentPseudo: this.$store.state.user.pseudo,\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    isLiked() {\r\n      const userId = this.$store.state.user.id;\r\n      let userLike = this.post.Likes.map((a) => a.UserId);\r\n      if (userLike.includes(userId)) {\r\n        return \"pink\";\r\n      } else {\r\n        return \"\";\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    async reloadFeed() {\r\n      try {\r\n        const response = await PostService.getPosts();\r\n        this.posts = response.data;\r\n      } catch (error) {\r\n        this.errorMessage = error.response.data.error;\r\n      }\r\n    },\r\n    getProfile(id) {\r\n      this.$router.push(`/account/${id}`);\r\n    },\r\n    deletePost() {\r\n      this.$emit(\"deletePost\", this.post.id);\r\n    },\r\n    likePost() {\r\n      this.$emit(\"likePost\", this.post.id);\r\n    },\r\n    getOnePost(id) {\r\n      this.$router.push(`posts/${id}`);\r\n    },\r\n    onSubmitComment(id) {\r\n      this.$store.dispatch(\"getPosts\");\r\n      this.$store.dispatch(\"commentPost\", {\r\n        id: id,\r\n        data: this.data,\r\n      });\r\n      this.data.commentMessage = \"\";\r\n      this.$store.dispatch(\"getPosts\");\r\n      this.$store.dispatch(\"getPostById\", this.post.id);\r\n    },\r\n    deleteComment(id) {\r\n      this.$store.dispatch(\"deleteComment\", id), this.reloadFeed();\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped></style>"]}]}